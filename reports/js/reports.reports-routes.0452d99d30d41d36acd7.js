"use strict";(self.webpackChunk_deriv_reports=self.webpackChunk_deriv_reports||[]).push([["reports-routes"],{"./src/Containers/index.ts":(e,t,n)=>{n.r(t),n.d(t,{default:()=>ve});var a=n("react"),r=n.n(a),o=n("react-router-dom"),l=n("@deriv/components"),i=n("@deriv/shared"),c=n("@deriv/translations"),s=n("../../node_modules/react-content-loader/dist/react-content-loader.es.js"),u=function(e){var t=e.speed;return r().createElement(s.ZP,{height:64,width:992,speed:t,backgroundColor:"var(--general-hover)",foregroundColor:"var(--general-active)"},r().createElement("rect",{x:"16",y:"16",rx:"4",ry:"4",width:"32",height:"32"}),r().createElement("rect",{x:"52",y:"16",rx:"4",ry:"4",width:"32",height:"32"}),r().createElement("rect",{x:"132",y:"28",rx:"4",ry:"4",width:"101",height:"8"}),r().createElement("rect",{x:"273",y:"28",rx:"4",ry:"4",width:"120",height:"8"}),r().createElement("rect",{x:"460",y:"28",rx:"4",ry:"4",width:"46",height:"8"}),r().createElement("rect",{x:"593",y:"28",rx:"4",ry:"4",width:"46",height:"8"}),r().createElement("rect",{x:"726",y:"28",rx:"4",ry:"4",width:"64",height:"8"}),r().createElement("rect",{x:"906",y:"28",rx:"4",ry:"4",width:"64",height:"8"}))},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?(0,i.getContractConfig)(t)[e.toUpperCase()].name:null};const _=function(e){var t=e.has_selected_date,n=e.component_icon,a=e.localized_message,o=e.localized_period_message;return r().createElement(r().Fragment,null,r().createElement("div",{className:"empty-trade-history"},r().createElement(l.Icon,{data_testid:"dt_empty_trade_history_icon",icon:n,className:"empty-trade-history__icon",color:"disabled",size:96}),r().createElement(l.Text,{size:"xs",align:"center",color:"disabled",className:"empty-trade-history__text"},t?o:a)))};var d=n("../../node_modules/classnames/index.js"),p=n.n(d),f=n("./src/Stores/connect.js");const v=(0,f.$j)((function(e){var t=e.common;return{is_loading:e.portfolio.is_loading,server_time:t.server_time}}))((function(e){var t=e.contract_info,n=e.is_loading,a=e.server_time;if(!t)return r().createElement("div",null);var o=t.tick_count&&(0,i.getCurrentTick)(t);return r().createElement(l.ProgressSlider,{current_tick:o,expiry_time:t.date_expiry,getCardLabels:i.getCardLabels,is_loading:n,server_time:a,start_time:t.date_start,ticks_count:t.tick_count})}));var y=function(e){return+e.replace(/,/g,"")>=0?"profit":"loss"};function g(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);c=!0);}catch(e){s=!0,r=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}const E=(0,f.$j)((function(e){return{onClickSell:e.portfolio.onClickSell}}))((function(e){var t=e.amount,n=e.currency,a=e.contract_info,o=e.is_footer,c=e.onClickSell,s=e.is_sell_requested,u=g(r().useState(null),2),m=u[0],_=u[1],d=g(r().useState(0),2),p=d[0],f=d[1];return r().useEffect((function(){_((function(){return t>=p?"profit":"loss"})),f(t)}),[t,p]),r().createElement("div",{className:"open-positions__indicative"},r().createElement("div",{className:"open-positions__indicative--amount"},r().createElement(l.Money,{amount:Math.abs(t),currency:n}),"no-resale"!==status&&0!==t&&r().createElement(r().Fragment,null,"profit"===m&&r().createElement(l.Icon,{icon:"IcProfit"}),"loss"===m&&r().createElement(l.Icon,{icon:"IcLoss"}))),r().createElement(l.DesktopWrapper,null,!o&&r().createElement(l.ContractCard.Sell,{contract_info:a,is_sell_requested:s,getCardLabels:i.getCardLabels,onClickSell:c})))})),C=function(e){var t,n=e.icon,a=e.payload,o=e.show_description,c=e.should_show_accumulator,s=void 0===c||c,u=e.should_show_multiplier,_=void 0===u||u,d=e.is_vanilla,f="string"==typeof a.shortcode,v=(0,i.extractInfoFromShortcode)(a.shortcode),y=(0,i.isHighLow)({shortcode_info:v}),g=d?v.category.replace("Vanillalong","").charAt(0).toUpperCase()+v.category.replace("Vanillalong","").slice(1):v.category;return f&&v?r().createElement("div",{className:p()("market-symbol-icon",{"market-symbol-icon__vanilla":d})},r().createElement("div",{className:"market-symbol-icon-name"},r().createElement(l.Popover,{classNameTarget:"market-symbol-icon__popover",classNameBubble:"market-symbol-icon__popover-bubble",alignment:"top",message:(t=v.underlying,t?(0,i.getMarketNamesMap)()[t.toUpperCase()]:null),is_bubble_hover_enabled:!0,disable_target_icon:!0},r().createElement(l.Icon,{icon:v.underlying?"IcUnderlying".concat(v.underlying):"IcUnknown",size:32})),o&&a.display_name),r().createElement("div",{className:"market-symbol-icon-category"},r().createElement(l.Popover,{classNameTarget:"category-type-icon__popover",classNameBubble:"category-type-icon__popover-bubble",alignment:"top",message:m(v.category,y),is_bubble_hover_enabled:!0,disable_target_icon:!0},r().createElement(l.IconTradeTypes,{type:y?"".concat(v.category.toLowerCase(),"_barrier"):v.category.toLowerCase(),color:"brand"})),o&&g),_&&v.multiplier&&r().createElement("div",{className:"market-symbol-icon__multiplier"},"x",v.multiplier),s&&v.growth_rate&&r().createElement("div",{className:"market-symbol-icon__multiplier"},100*v.growth_rate,"%")):["deposit","hold","release","withdrawal","transfer"].includes(a.action_type)?r().createElement("div",{className:"market-symbol-icon"},"deposit"===a.action_type&&r().createElement(l.Icon,{icon:n||"IcCashierDeposit",size:32}),"withdrawal"===a.action_type&&r().createElement(l.Icon,{icon:"IcCashierWithdrawal",size:32}),"transfer"===a.action_type&&r().createElement(l.Icon,{icon:"IcAccountTransferColored",size:32}),("hold"===a.action_type||"release"===a.action_type)&&r().createElement(l.Icon,{icon:"IcCashierDp2p",size:32})):["adjustment"].includes(a.action_type)?r().createElement("div",{className:"market-symbol-icon"},r().createElement(l.Icon,{icon:"IcAdjustment",size:32})):r().createElement("svg",{width:"32",height:"32",className:"unknown-icon"},r().createElement("rect",{width:"32",height:"32"}))},b=function(e){var t=e.value,n=e.children,a=y(t);return r().createElement("span",{className:"amount--".concat(a)},n)},w=function(e){var t=e.currency;return r().createElement("div",{className:"currency__wrapper"},r().createElement(l.Text,{color:"colored-background",weight:"bold",size:"xxxs"},t))};var x={buy:"success",deposit:"success",hold:"warn",release:"success",sell:"danger",withdrawal:"info",default:"default",adjustment:"adjustment",transfer:"transfer"},N=n("../../node_modules/prop-types/index.js"),k=n.n(N);const z=function(e){var t=e.className,n=e.is_invisible,a=e.theme,o=e.id,l=e.data_testid;return r().createElement("div",{id:o,"data-testid":l,className:p()("barspinner","barspinner--".concat(a||"dark"),{invisible:n},t)},Array.from(new Array(5)).map((function(e,t){return r().createElement("div",{key:t,className:"barspinner__rect barspinner__rect--".concat(t+1," rect").concat(t+1)})})))};var M=function(e){var t=e.empty_message_component;return r().createElement(r().Fragment,null,e.is_empty&&r().createElement(t,{component_icon:e.component_icon,has_selected_date:e.has_selected_date,localized_message:e.localized_message,localized_period_message:e.localized_period_message}),e.is_loading&&r().createElement(z,{data_testid:"dt_loading_component"}))};M.propTypes={component_icon:k().string,empty_message_component:k().func,has_selected_date:k().bool,is_empty:k().bool,is_loading:k().bool,localized_message:k().string,localized_period_message:k().string};const D=M;var S=["row","is_footer","columns_map","server_time","onClickCancel","onClickSell","measure"],T=["active_positions","component_icon","currency","error","getPositionById","is_accumulator","is_loading","is_multiplier","is_vanilla","NotificationMessages","onClickCancel","onClickSell","onMount","server_time"];function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);c=!0);}catch(e){s=!0,r=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?I(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function L(){return L=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},L.apply(this,arguments)}function A(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var P=function(e){var t=e.is_empty,n=e.component_icon,a=e.children;return r().createElement(r().Fragment,null,t?r().createElement(D,{is_empty:t,empty_message_component:_,component_icon:n,localized_message:(0,c.localize)("You have no open positions yet.")}):a)},O=function(e){var t,n=e.row,a=e.is_footer,o=e.columns_map,s=e.server_time,u=e.onClickCancel,m=e.onClickSell,_=e.measure,d=A(e,S);if(r().useEffect((function(){a||_()}),[null===(t=n.contract_info)||void 0===t?void 0:t.underlying,_,a]),a)return r().createElement(r().Fragment,null,r().createElement("div",{className:"open-positions__data-list-footer--content"},r().createElement("div",null,r().createElement(l.DataList.Cell,{row:n,column:o.purchase}),r().createElement(l.DataList.Cell,{row:n,column:o.payout})),r().createElement("div",null,r().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:n,column:o.indicative}),r().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:n,column:o.profit}))));var p=n.contract_info,f=n.contract_update,v=n.type,y=n.is_sell_requested,g=p.currency,h=p.status,E=p.date_expiry,C=p.date_start,b=p.tick_count,w=p.purchase_time,x=b?(0,i.getCurrentTick)(p):null,N=function(e,t){if(/^(MULTUP|MULTDOWN)/.test(void 0))return"";var n=new RegExp("ticks|tick|seconds|minutes|minute|hour|hours").exec(e);if(null!==n){var a=n[0],r=a[0].toUpperCase()+a.slice(1);return r.endsWith("s")?r:"".concat(r,"s")}return(0,c.localize)("Days")}(p.longcode),k=(0,i.getTimePercentage)(s,null!=C?C:0,null!=E?E:0)/100;return(0,i.isMultiplierContract)(null!=v?v:"")||(0,i.isAccumulatorContract)(null!=v?v:"")?r().createElement(l.PositionsDrawerCard,L({contract_info:p,contract_update:f,currency:g,is_link_disabled:!0,onClickCancel:u,onClickSell:m,server_time:s,status:h,measure:_},d)):r().createElement(r().Fragment,null,r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:n,column:o.type}),(0,i.isVanillaContract)(null!=v?v:"")?r().createElement(l.ProgressSliderMobile,{current_tick:x,className:"data-list__row--vanilla",expiry_time:E,getCardLabels:i.getCardLabels,is_loading:!1,server_time:s,start_time:w,ticks_count:b}):r().createElement(l.ProgressBar,{label:N,value:k})),r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:n,column:o.reference}),r().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:n,column:o.currency})),r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:n,column:o.purchase}),r().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:n,column:o.indicative})),r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:n,column:o.payout}),r().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:n,column:o.profit})),r().createElement("div",{className:"data-list__row-divider"}),r().createElement("div",{className:"data-list__row"},r().createElement(l.ContractCard.Sell,{contract_info:p,is_sell_requested:y,getCardLabels:i.getCardLabels,onClickSell:m})))},F=function(e){var t=e.className,n=e.columns,a=e.component_icon,o=e.currency,i=e.active_positions,s=e.is_loading,m=e.getRowAction,d=e.mobileRowRenderer,p=e.preloaderCheck,f=e.row_size,v=e.totals,y=e.is_empty;return r().createElement(r().Fragment,null,s?r().createElement(D,{is_loading:s,empty_message_component:_,component_icon:a,localized_message:(0,c.localize)("You have no open positions yet.")}):o&&r().createElement("div",{className:"reports__content"},r().createElement(l.DesktopWrapper,null,r().createElement(P,{component_icon:a,is_empty:y},r().createElement(l.DataTable,{className:t,columns:n,preloaderCheck:p,footer:v,data_source:i,getRowAction:m,getRowSize:function(){return f},content_loader:u},r().createElement(D,{is_loading:s})))),r().createElement(l.MobileWrapper,null,r().createElement(P,{component_icon:a,is_empty:y},r().createElement(l.DataList,{className:t,data_source:i,footer:v,rowRenderer:d,getRowAction:m,row_gap:8,keyMapper:function(e){return null==e?void 0:e.id}},r().createElement(D,{is_loading:s}))))))},R=function(e){var t;return e.is_unsupported?{component:r().createElement(c.Localize,{i18n_default_text:"The {{trade_type_name}} contract details aren't currently available. We're working on making them available soon.",values:{trade_type_name:null===(t=(0,i.getUnsupportedContracts)()[e.type])||void 0===t?void 0:t.name}})}:(0,i.getContractPath)(e.id)},U=function(e){return isNaN(e.purchase)||!e.purchase};const Y=(0,o.withRouter)((0,f.$j)((function(e){var t=e.client,n=e.common,a=e.ui,r=e.portfolio,o=e.contract_trade;return{active_positions:r.active_positions,currency:t.currency,error:r.error,getPositionById:r.getPositionById,is_accumulator:r.is_accumulator,is_loading:r.is_loading,is_multiplier:r.is_multiplier,NotificationMessages:a.notification_messages_ui,onClickCancel:r.onClickCancel,onClickSell:r.onClickSell,onMount:r.onMount,server_time:n.server_time,addToast:a.addToast,current_focus:a.current_focus,onClickRemove:r.removePositionById,getContractById:o.getContractById,is_mobile:a.is_mobile,removeToast:a.removeToast,setCurrentFocus:a.setCurrentFocus,should_show_cancellation_warning:a.should_show_cancellation_warning,toggleCancellationWarning:a.toggleCancellationWarning,toggleUnsupportedContractModal:a.toggleUnsupportedContractModal}}))((function(e){var t,n=e.active_positions,a=e.component_icon,o=e.currency,s=e.error,u=e.getPositionById,m=e.is_accumulator,_=e.is_loading,d=e.is_multiplier,f=(e.is_vanilla,e.NotificationMessages),y=e.onClickCancel,g=e.onClickSell,h=e.onMount,b=e.server_time,x=A(e,T),N=j(r().useState(!1),2),k=N[0],z=N[1],M=j(r().useState(!1),2),D=M[0],S=M[1],I=(0,l.usePrevious)(n),P=[{text:(0,c.localize)("Options"),is_default:!d&&!m},{text:(0,c.localize)("Multipliers"),is_default:d},{text:(0,c.localize)("Accumulators"),is_default:m}],Y=j(r().useState((null===(t=P.find((function(e){return e.is_default})))||void 0===t?void 0:t.text)||(0,c.localize)("Options")),2),W=Y[0],B=Y[1],q=[(0,c.localize)("All growth rates"),"1%","2%","3%","4%","5%"],$=j(r().useState(q[0]),2),G=$[0],V=$[1],H=W===P[2].text,Z=W===P[1].text,K=P.map((function(e){var t=e.text;return{text:t,value:t}})),J=q.map((function(e){return{text:e,value:e}})),Q=null==n?void 0:n.filter((function(e){var t=e.contract_info;return!t||(Z?(0,i.isMultiplierContract)(t.contract_type):H?(0,i.isAccumulatorContract)(t.contract_type)&&("".concat((0,i.getGrowthRatePercentage)(t.growth_rate),"%")===G||!G.includes("%")):!(0,i.isMultiplierContract)(t.contract_type)&&!(0,i.isAccumulatorContract)(t.contract_type))})),X=function(e,t,n){var a;if(t){var r=0,o=0,l=0,c=0,s=0;e.forEach((function(e){if(l+=Number(e.contract_info.buy_price),c+=Number(e.contract_info.bid_price),s+=Number(e.purchase),e.contract_info){var t,n,a={bid_price:null!==(t=e.contract_info.bid_price)&&void 0!==t?t:0,buy_price:null!==(n=e.contract_info.buy_price)&&void 0!==n?n:0};o+=(0,i.getTotalProfit)(a),e.contract_info.cancellation&&(r+=e.contract_info.cancellation.ask_price||0)}})),a={contract_info:{profit:o,buy_price:l,bid_price:c},purchase:s},r>0&&a.contract_info&&(a.contract_info.cancellation={ask_price:r})}else if(n){var u=0,m=0,_=0,d=0;null==e||e.forEach((function(e){var t,n,a=e.contract_info;u+=+a.buy_price,m+=+a.bid_price,_+=null===(t=a.limit_order)||void 0===t||null===(n=t.take_profit)||void 0===n?void 0:n.order_amount,a&&(d+=(0,i.getTotalProfit)(a))})),a={contract_info:{buy_price:u,bid_price:m,profit:d,limit_order:{take_profit:{order_amount:_}}},purchase:u}}else{var p=0,f=0,v=0,y=0;null==e||e.forEach((function(e){p+=+e.indicative,f+=Number(e.purchase),v+=Number(e.profit_loss),y+=Number(e.payout)})),a={indicative:p,purchase:f,profit_loss:v,payout:y}}return a}(Q,Z,H);r().useEffect((function(){h(),ee()}),[]),r().useEffect((function(){ee(I)}),[I]);var ee=function(){n!==(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[])&&(k||z(n.some((function(e){var t=e.contract_info;return(0,i.isAccumulatorContract)(null==t?void 0:t.contract_type)}))),D||S(n.some((function(e){var t=e.contract_info;return(0,i.isMultiplierContract)(null==t?void 0:t.contract_type)}))))};if(s)return r().createElement("p",null,s);var te=Z?function(e){var t=e.currency,n=e.onClickCancel,a=e.onClickSell,o=e.getPositionById,s=e.server_time;return[{title:(0,i.isMobile)()?"":(0,c.localize)("Type"),col_index:"type",renderCellContent:function(e){var t=e.row_obj;return e.is_footer?(0,c.localize)("Total"):r().createElement(C,{key:t.id,payload:t.contract_info,should_show_multiplier:!1})}},{title:(0,c.localize)("Multiplier"),col_index:"multiplier",renderCellContent:function(e){var t=e.row_obj;return t.contract_info&&t.contract_info.multiplier?"x".concat(t.contract_info.multiplier):""}},{title:(0,c.localize)("Currency"),col_index:"currency",renderCellContent:function(e){var t,n=e.row_obj;return r().createElement(w,{currency:(0,i.getCurrencyDisplayCode)(null===(t=n.contract_info)||void 0===t?void 0:t.currency)})}},{title:(0,c.localize)("Stake"),col_index:"buy_price",renderCellContent:function(e){var n=e.row_obj;if(n.contract_info){var a=(n.contract_info.cancellation||{}).ask_price,o=void 0===a?0:a;return r().createElement(l.Money,{amount:n.contract_info.buy_price-o,currency:t})}return""}},{title:(0,c.localize)("Deal cancel. fee"),col_index:"cancellation",renderCellContent:function(e){var n=e.row_obj;return n.contract_info&&n.contract_info.underlying?(0,i.shouldShowCancellation)(n.contract_info.underlying)?n.contract_info.cancellation?r().createElement(l.Money,{amount:n.contract_info.cancellation.ask_price,currency:t}):"-":(0,c.localize)("N/A"):"-"}},{title:(0,i.isMobile)()?r().createElement(c.Localize,{i18n_default_text:"Total buy price"}):r().createElement(c.Localize,{i18n_default_text:"Buy price"}),col_index:"purchase",renderCellContent:function(e){var n=e.cell_value;return r().createElement(l.Money,{amount:n,currency:t})}},{title:r().createElement(c.Localize,{i18n_default_text:"Take profit<0 />Stop loss",components:[r().createElement("br",{key:0})]}),col_index:"limit_order",renderCellContent:function(e){var n,a=e.row_obj;if(e.is_footer)return"";var o=(null===(n=a.contract_info)||void 0===n?void 0:n.limit_order)||{},i=o.take_profit,c=o.stop_loss;return r().createElement(r().Fragment,null,r().createElement("div",null,null!=i&&i.order_amount?r().createElement(l.Money,{has_sign:!0,amount:i.order_amount,currency:t}):"-"),r().createElement("div",null,null!=c&&c.order_amount?r().createElement(l.Money,{has_sign:!0,amount:c.order_amount,currency:t}):"-"))}},{title:(0,c.localize)("Current stake"),col_index:"bid_price",renderCellContent:function(e){var n=e.row_obj;if(e.is_footer)return"";if(!n.contract_info||!n.contract_info.bid_price)return"-";var a=(0,i.getTotalProfit)(n.contract_info);return r().createElement("div",{className:p()("open-positions__bid_price",{"open-positions__bid_price--negative":a<0,"open-positions__bid_price--positive":a>0})},r().createElement(l.Money,{amount:n.contract_info.bid_price,currency:t}))}},{title:(0,i.isMobile)()?r().createElement(c.Localize,{i18n_default_text:"Total profit/loss"}):r().createElement(c.Localize,{i18n_default_text:"Total<0 />profit/loss",components:[r().createElement("br",{key:0})]}),col_index:"profit",renderCellContent:function(e){var n=e.row_obj;if(!n.contract_info||!n.contract_info.profit)return null;var a=(0,i.getTotalProfit)(n.contract_info);return r().createElement("div",{className:p()("open-positions__profit-loss",{"open-positions__profit-loss--negative":a<0,"open-positions__profit-loss--positive":a>0})},r().createElement(l.Money,{amount:Math.abs(a),currency:t}),r().createElement("div",{className:"open-positions__profit-loss--movement"},a>0?r().createElement(l.Icon,{icon:"IcProfit"}):r().createElement(l.Icon,{icon:"IcLoss"})))}},{title:(0,c.localize)("Action"),col_index:"action",renderCellContent:function(e){var t=e.row_obj;if(e.is_footer)return r().createElement("div",{className:"open-positions__row-action"});var c=t.contract_info,u=(o(c.contract_id)||{}).is_sell_requested;return r().createElement("div",{className:"open-positions__row-action"},r().createElement(l.ContractCard.MultiplierCloseActions,{contract_info:c,getCardLabels:i.getCardLabels,is_sell_requested:u,onClickCancel:n,onClickSell:a,server_time:s}))}}]}({currency:o,onClickCancel:y,onClickSell:g,getPositionById:u,server_time:b}):H?function(e){var t=e.currency,n=e.onClickSell,a=e.getPositionById;return[{title:(0,i.isMobile)()?"":(0,c.localize)("Type"),col_index:"type",renderCellContent:function(e){var t=e.row_obj;return e.is_footer?(0,c.localize)("Total"):r().createElement(C,{key:t.id,payload:t.contract_info,should_show_multiplier:!1,should_show_accumulator:!1})}},{title:(0,c.localize)("Growth rate"),col_index:"growth_rate",renderCellContent:function(e){var t=e.row_obj;return t.contract_info&&t.contract_info.growth_rate?"".concat((0,i.getGrowthRatePercentage)(t.contract_info.growth_rate),"%"):""}},{title:(0,c.localize)("Currency"),col_index:"currency",renderCellContent:function(e){var t,n=e.row_obj;return r().createElement(w,{currency:(0,i.getCurrencyDisplayCode)(null===(t=n.contract_info)||void 0===t?void 0:t.currency)})}},{title:(0,i.isMobile)()?(0,c.localize)("Total stake"):(0,c.localize)("Initial stake"),col_index:(0,i.isMobile)()?"purchase":"buy_price",renderCellContent:function(e){var n=e.row_obj;return n.contract_info?r().createElement(l.Money,{amount:n.contract_info.buy_price,currency:t}):""}},{title:(0,c.localize)("Take profit"),col_index:"limit_order",renderCellContent:function(e){var n,a=((null===(n=e.row_obj.contract_info)||void 0===n?void 0:n.limit_order)||{}).take_profit;return r().createElement("div",null,null!=a&&a.order_amount?r().createElement(l.Money,{has_sign:!0,amount:a.order_amount,currency:t}):"-")}},{title:(0,c.localize)("Current stake"),col_index:"bid_price",renderCellContent:function(e){var n=e.row_obj;if(!n.contract_info||!n.contract_info.bid_price)return"-";var a=(0,i.getTotalProfit)(n.contract_info);return r().createElement("div",{className:p()("open-positions__bid_price",{"open-positions__bid_price--negative":a<0,"open-positions__bid_price--positive":a>0})},r().createElement(l.Money,{amount:n.contract_info.bid_price,currency:t}))}},{title:(0,c.localize)("Total profit/loss"),col_index:"profit",renderCellContent:function(e){var n=e.row_obj;if(!n.contract_info||!n.contract_info.profit)return null;var a=(0,i.getTotalProfit)(n.contract_info);return r().createElement("div",{className:p()("open-positions__profit-loss",{"open-positions__profit-loss--negative":a<0,"open-positions__profit-loss--positive":a>0})},r().createElement(l.Money,{amount:Math.abs(a),currency:t}),r().createElement("div",{className:"open-positions__profit-loss--movement"},a>0?r().createElement(l.Icon,{icon:"IcProfit"}):r().createElement(l.Icon,{icon:"IcLoss"})))}},{title:(0,c.localize)("Action"),col_index:"action",renderCellContent:function(e){var t=e.row_obj;if(e.is_footer)return r().createElement("div",{className:"open-positions__row-action"});var o=t.contract_info,c=(a(o.contract_id)||{}).is_sell_requested;return r().createElement("div",{className:"open-positions__row-action"},r().createElement(l.ContractCardSell,{contract_info:o,is_sell_requested:c,getCardLabels:i.getCardLabels,onClickSell:n}))}}]}({currency:o,onClickSell:g,getPositionById:u}):function(e){return[{key:"icon",title:(0,i.isMobile)()?"":(0,c.localize)("Type"),col_index:"type",renderCellContent:function(e){var t=e.row_obj,n=e.is_footer,a=e.is_vanilla;return n?(0,c.localize)("Total"):r().createElement(C,{key:t.id,payload:t.contract_info,show_description:a,is_vanilla:a})}},{title:(0,c.localize)("Ref. ID"),col_index:"reference"},{title:(0,c.localize)("Currency"),col_index:"currency",renderCellContent:function(e){var t,n=e.row_obj;return r().createElement(w,{currency:(0,i.getCurrencyDisplayCode)(null===(t=n.contract_info)||void 0===t?void 0:t.currency)})}},{title:(0,c.localize)("Buy price"),col_index:"purchase",renderCellContent:function(t){var n=t.cell_value;return r().createElement(l.Money,{amount:n,currency:e})}},{title:(0,c.localize)("Payout limit"),col_index:"payout",renderHeader:function(e){var t=e.title,n=e.is_vanilla;return r().createElement("span",null,n?(0,c.localize)("Strike"):t)},renderCellContent:function(t){var n,a=t.cell_value,o=t.row_obj,i=t.is_vanilla,c=a?r().createElement(l.Money,{amount:a,currency:e}):r().createElement("span",null,"-");return i?null===(n=o.barrier)||void 0===n?void 0:n.toFixed(2):c}},{title:(0,c.localize)("Indicative profit/loss"),col_index:"profit",renderCellContent:function(t){var n=t.row_obj;if(n.profit_loss||n.contract_info&&n.contract_info.profit){var a=n.profit_loss||n.contract_info.profit;return r().createElement("div",{className:p()("open-positions__profit-loss",{"open-positions__profit-loss--negative":a<0,"open-positions__profit-loss--positive":a>0})},r().createElement(l.Money,{amount:Math.abs(a),currency:e}),r().createElement("div",{className:"open-positions__profit-loss--movement"},a>0?r().createElement(l.Icon,{icon:"IcProfit"}):r().createElement(l.Icon,{icon:"IcLoss"})))}}},{title:(0,c.localize)("Indicative price"),col_index:"indicative",renderCellContent:function(t){var n=t.cell_value,a=t.row_obj,o=t.is_footer;return r().createElement(E,{amount:+n,currency:e,contract_info:a.contract_info,is_sell_requested:a.is_sell_requested,is_footer:o})}},{title:(0,c.localize)("Remaining time"),col_index:"id",renderCellContent:function(e){var t=e.row_obj;return r().createElement(v,{contract_info:t.contract_info})}}]}(o),ne={};te.forEach((function(e){ne[e.col_index]=e}));var ae,re,oe={active_positions:Q,component_icon:a,currency:o,is_loading:_,mobileRowRenderer:function(e){return r().createElement(O,L({},e,{columns_map:ne,server_time:b,onClickCancel:y,onClickSell:g},x))},getRowAction:R,preloaderCheck:U,totals:X};return r().createElement(r().Fragment,null,r().createElement(f,null),0!==n.length&&r().createElement(r().Fragment,null,r().createElement(l.DesktopWrapper,null,r().createElement("div",{className:H?"open-positions__accumulator-container":"open-positions__contract-types-selector-container"},r().createElement("div",{className:"open-positions__accumulator-container__contract-dropdown"},r().createElement(l.Dropdown,{is_align_text_left:!0,name:"contract_types",list:K,value:W,onChange:function(e){return B(e.target.value)}})),H&&r().createElement("div",{className:"open-positions__accumulator-container__rates-dropdown"},r().createElement(l.Dropdown,{is_align_text_left:!0,name:"accumulator_rates",list:J,value:G,onChange:function(e){return V(e.target.value)}})))),r().createElement(l.MobileWrapper,null,r().createElement("div",{className:H?"open-positions__accumulator-container--mobile":"open-positions__contract-types-selector-container--mobile"},r().createElement(l.SelectNative,{className:"open-positions__accumulator-container-mobile__contract-dropdown",list_items:K,value:W,should_show_empty_option:!1,onChange:function(e){return B(e.target.value)}}),H&&r().createElement(l.SelectNative,{className:"open-positions__accumulator-container--mobile__rates-dropdown",list_items:J,value:G,should_show_empty_option:!1,onChange:function(e){return V(e.target.value)}})))),(ae="open-positions",re=(0,i.isMobile)()?5:63,H?(ae="open-positions-accumulator open-positions",re=(0,i.isMobile)()?3:68):Z&&(ae="open-positions-multiplier open-positions",re=(0,i.isMobile)()?3:68),r().createElement(F,L({className:ae,columns:te,is_empty:0===Q.length,row_size:re},oe))))})));var W=n("react-router"),B=n("../../node_modules/react-loadable/lib/index.js"),q=n.n(B);function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);c=!0);}catch(e){s=!0,r=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?G(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var V=function(e){var t=e.id,n=e.className,a=e.selected_value,o=e.value,i=e.label,c=e.onChange;return r().createElement("label",{htmlFor:t,className:p()("composite-calendar-modal__radio",n,{"composite-calendar-modal__radio--selected":a===o}),onClick:function(){return c({label:i,value:o})}},r().createElement("input",{className:"composite-calendar-modal__radio-input",id:t,type:"radio",value:o}),r().createElement("span",{className:p()("composite-calendar-modal__radio-circle",{"composite-calendar-modal__radio-circle--selected":a===o})}),r().createElement(l.Text,{as:"p",color:"prominent",size:"xs",line_height:"unset",weight:a===o?"bold":"normal"},i))},H="custom",Z=r().memo((function(e){var t=e.input_date_range,n=e.current_focus,a=e.duration_list,o=e.onChange,s=e.setCurrentFocus,u=e.from,m=e.to,_=t||a.find((function(e){return"all_time"===e.value})),d=$(r().useState(u?(0,i.toMoment)(u).format("YYYY-MM-DD"):void 0),2),p=d[0],f=d[1],v=$(r().useState(m?(0,i.toMoment)(m).format("YYYY-MM-DD"):void 0),2),y=v[0],g=v[1],h=$(r().useState(!1),2),E=h[0],C=h[1],b=$(r().useState(_),2),w=b[0],x=b[1],N=$(r().useState(_),2),k=N[0],z=N[1],M=(0,i.toMoment)().format("YYYY-MM-DD"),D=function(e,t){var n=e.duration;o({from:t||n?(0,i.toMoment)().startOf("day").subtract(n,"day").add(1,"s"):void 0,to:(0,i.toMoment)().endOf("day"),is_batch:!0},{date_range:e})},S=function(e,t){var n,a;z({value:H}),"from"===t&&f(null===(n=e.target)||void 0===n?void 0:n.value),"to"===t&&g(null===(a=e.target)||void 0===a?void 0:a.value)},T=function(e){z(a.find((function(t){return e&&t.value===e.value}))||e)};return r().createElement(r().Fragment,null,r().createElement("div",{className:"composite-calendar__input-fields composite-calendar__input-fields--fill"},r().createElement(l.InputField,{id:"dt_calendar_input",current_focus:n,is_read_only:!0,icon:function(){return r().createElement(l.Icon,{icon:"IcCalendarDatefrom",className:"inline-icon"})},onClick:function(){z(w),C(!0)},setCurrentFocus:s,value:w.label})),r().createElement(l.MobileDialog,{portal_element_id:"modal_root",title:(0,c.localize)("Please select duration"),visible:E,has_content_scroll:!0,onClose:function(){return C(!1)},content_height_offset:"94px",footer:r().createElement("div",{className:"composite-calendar-modal__actions"},r().createElement(l.Button,{className:"composite-calendar-modal__actions__cancel",text:(0,c.localize)("Cancel"),onClick:function(){return C(!1)},has_effect:!0,secondary:!0,large:!0}),r().createElement(l.Button,{className:"composite-calendar-modal__actions__ok",text:(0,c.localize)("OK"),onClick:function(){var e,t,n;k.onClick?D(k):k.value===H&&(e=p||y||M,t=y||M,n=Object.assign(k,{label:"".concat((0,i.toMoment)(e).format("DD MMM YYYY")," - ").concat((0,i.toMoment)(t).format("DD MMM YYYY"))}),o({from:(0,i.toMoment)(e).startOf("day").add(1,"s"),to:(0,i.toMoment)(t).endOf("day"),is_batch:!0},{date_range:n})),x(k),C(!1)},has_effect:!0,primary:!0,large:!0}))},r().createElement("div",{className:"composite-calendar-modal"},r().createElement("div",{className:"composite-calendar-modal__radio-group"},a.map((function(e){return r().createElement(V,{id:"composite-calendar-modal__radio__".concat(e.value),key:e.value,value:e.value,label:e.label,selected_value:k.value,onChange:T})}))),r().createElement("div",{className:"composite-calendar-modal__custom"},r().createElement(V,{id:"composite-calendar-modal__custom-radio",className:"composite-calendar-modal__custom-radio",value:H,label:(0,c.localize)("Custom"),selected_value:k.value,onChange:T}),r().createElement("div",{className:"composite-calendar-modal__custom-date-range"},r().createElement(l.DatePicker,{className:"composite-calendar-modal__custom-date-range-start-date",is_nativepicker:!0,placeholder:(0,c.localize)("Start date"),value:p,max_date:y||M,onChange:function(e){return S(e,"from")}}),r().createElement(l.DatePicker,{className:"composite-calendar-modal__custom-date-range-end-date",is_nativepicker:!0,placeholder:(0,c.localize)("End date"),value:y,max_date:M,min_date:p,onChange:function(e){return S(e,"to")}}))),r().createElement(l.Button,{className:"composite-calendar-modal__actions-today",text:(0,c.localize)("Back to today"),onClick:function(){var e={duration:0,label:(0,c.localize)("Today")};D(e,!0),x(e),z(e),C(!1)},has_effect:!0,tertiary:!0,large:!0}))))}));Z.displayName="CompositeCalendarMobile";const K=Z,J=function(e){var t=e.onClick,n=e.is_active,a=e.label;return r().createElement("li",{className:p()({"composite-calendar__prepopulated-list--is-active":n}),onClick:t},a)},Q=function(e){var t=e.items,n=e.from,a=e.to;return r().createElement("ul",{className:"composite-calendar__prepopulated-list"},t.map((function(e){var t=e.duration,o=e.label,l=e.onClick,c=function(e,t,n){return 0===n?(0,i.toMoment)().endOf("day").unix()===t&&null===e:Math.ceil(t/86400)-Math.ceil(e/86400)===n}(n,a,t);return r().createElement(J,{key:t,is_active:c,label:o,onClick:l})})))},X=function(e){var t=e.onClick;return r().createElement(l.Icon,{onClick:t,icon:"IcCalendarDatefrom",className:"inline-icon"})};function ee(){return ee=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},ee.apply(this,arguments)}function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var a,r,o,l,i=[],c=!0,s=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(a=o.call(n)).done)&&(i.push(a.value),i.length!==t);c=!0);}catch(e){s=!0,r=e}finally{try{if(!c&&null!=n.return&&(l=n.return(),Object(l)!==l))return}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ne(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ne(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}var ae=q()({loader:function(){return Promise.all([n.e("vendors-node_modules_moment_moment_js"),n.e("two-month-picker")]).then(n.bind(n,"./src/Components/Form/CompositeCalendar/two-month-picker.tsx"))},loading:function(){return null},render:function(e,t){var n=e.default;return r().createElement(n,t)}}),re=function(e){var t,n=e.current_focus,a=e.onChange,o=e.setCurrentFocus,s=e.to,u=e.from,m=te(r().useState(!1),2),_=m[0],d=m[1],p=te(r().useState(!1),2),f=p[0],v=p[1],y=te(r().useState([{value:"all_time",label:(0,c.localize)("All time"),onClick:function(){return h()},duration:0},{value:"last_7_days",label:(0,c.localize)("Last 7 days"),onClick:function(){return h(7)},duration:7},{value:"last_30_days",label:(0,c.localize)("Last 30 days"),onClick:function(){return h(30)},duration:30},{value:"last_60_days",label:(0,c.localize)("Last 60 days"),onClick:function(){return h(60)},duration:60},{value:"last_quarter",label:(0,c.localize)("Last quarter"),onClick:function(){return h(90)},duration:90}]),1)[0],g=r().useRef(null),h=function(e){E(),a({from:e?(0,i.toMoment)().startOf("day").subtract(e,"day").add(1,"s"):void 0,to:(0,i.toMoment)().endOf("day"),is_batch:!0})},E=function(){v(!1),d(!1)},C=function(e){"from"===e&&v(!0),"to"===e&&d(!0)};return(0,l.useOnClickOutside)(g,(function(e){null==e||e.stopPropagation(),null==e||e.preventDefault(),E()}),(function(e){var t;return!(null!==(t=g.current)&&void 0!==t&&t.contains(e.target))})),r().createElement(r().Fragment,null,r().createElement(l.DesktopWrapper,null,r().createElement("div",{id:"dt_composite_calendar_inputs",className:"composite-calendar__input-fields"},r().createElement(l.InputField,{id:"dt_calendar_input_from",current_focus:n,is_read_only:!0,placeholder:(0,c.localize)("Date from"),icon:X,onClick:function(){return C("from")},setCurrentFocus:o,value:(t=(0,i.toMoment)(u),u?t.format("MMM, DD YYYY"):"")}),r().createElement(l.InputField,{id:"dt_calendar_input_to",current_focus:n,is_read_only:!0,placeholder:(0,c.localize)("Date to"),icon:X,onClick:function(){return C("to")},setCurrentFocus:o,value:function(){var e=(0,i.toMoment)(s);return 0===(0,i.daysFromTodayTo)(e)?(0,c.localize)("Today"):e.format("MMM, DD YYYY")}()})),_&&r().createElement("div",{className:"composite-calendar",ref:g},r().createElement(Q,{from:u,to:s,items:y}),r().createElement(ae,{value:s,onChange:function(e){a({to:(0,i.toMoment)(e).endOf("day")})},isPeriodDisabled:function(e){return e.unix()<u||e.unix()>(0,i.toMoment)().endOf("day").unix()}})),f&&r().createElement("div",{className:"composite-calendar",ref:g},r().createElement(Q,{from:u,to:s,items:y}),r().createElement(ae,{value:u,onChange:function(e){a({from:(0,i.toMoment)(e)}),E()},isPeriodDisabled:function(e){return e.unix()>s}}))),r().createElement(l.MobileWrapper,null,r().createElement(K,ee({duration_list:y},e))))};re.displayName="CompositeCalendar";const oe=r().memo((0,f.$j)((function(e){var t=e.ui;return{current_focus:t.current_focus,setCurrentFocus:t.setCurrentFocus}}))(re));var le=function(e){var t=e.filter_component,n=e.className,a=e.optional_component,o=e.is_statement;return r().createElement("div",{className:p()("reports__meta",n)},a,t&&r().createElement("div",{className:p()("reports__meta-filter",{"reports__meta-filter--statement":o})},t))},ie=function(e){var t,n,a,o=null===(t=(0,i.extractInfoFromShortcode)(null==e?void 0:e.shortcode))||void 0===t||null===(n=t.category)||void 0===n?void 0:n.toString().toUpperCase();return(0,i.getSupportedContracts)()[o]&&!(0,i.isForwardStarting)(e.shortcode,+e.purchase_time_unix)?(0,i.getContractPath)(+e.contract_id):{component:r().createElement(c.Localize,{i18n_default_text:"The {{trade_type_name}} contract details aren't currently available. We're working on making them available soon.",values:{trade_type_name:null===(a=(0,i.getUnsupportedContracts)()[o])||void 0===a?void 0:a.name}})}};const ce=(0,f.$j)((function(e){var t=e.modules,n=e.client;return{currency:n.currency,data:t.profit_table.data,date_from:t.profit_table.date_from,date_to:t.profit_table.date_to,error:t.profit_table.error,filtered_date_range:t.profit_table.filtered_date_range,is_empty:t.profit_table.is_empty,is_loading:t.profit_table.is_loading,is_switching:n.is_switching,handleDateChange:t.profit_table.handleDateChange,handleScroll:t.profit_table.handleScroll,has_selected_date:t.profit_table.has_selected_date,onMount:t.profit_table.onMount,onUnmount:t.profit_table.onUnmount,totals:t.profit_table.totals}}))((0,W.withRouter)((function(e){var t=e.component_icon,n=e.currency,a=e.data,o=e.date_from,s=e.date_to,m=e.error,d=e.filtered_date_range,f=e.is_empty,v=e.is_loading,y=e.is_switching,g=e.handleDateChange,h=e.handleScroll,E=e.has_selected_date,x=e.onMount,N=e.onUnmount,k=e.totals;if(r().useEffect((function(){return x(),function(){N()}}),[]),m)return r().createElement("p",null,m);var z=r().createElement(oe,{input_date_range:d,onChange:g,from:o,to:s}),M=function(e,t){return[{key:"icon",title:(0,i.isMobile)()?"":(0,c.localize)("Type"),col_index:"action_type",renderCellContent:function(e){var n=e.row_obj;return e.is_footer?(0,c.localize)("Profit/loss on the last {{item_count}} contracts",{item_count:t}):r().createElement(C,{key:n.transaction_id,payload:n})}},{title:(0,c.localize)("Ref. ID"),col_index:"transaction_id"},{title:(0,c.localize)("Currency"),col_index:"currency",renderCellContent:function(t){return t.is_footer?"":r().createElement(w,{currency:(0,i.getCurrencyDisplayCode)(e)})}},{title:(0,c.localize)("Buy time"),col_index:"purchase_time",renderCellContent:function(e){var t=e.cell_value;return e.is_footer?"":r().createElement("span",null,t," GMT")}},{title:(0,c.localize)("Buy price"),col_index:"buy_price",renderCellContent:function(t){var n=t.cell_value;return t.is_footer?"":r().createElement(l.Money,{amount:n,currency:e})}},{title:(0,c.localize)("Sell time"),col_index:"sell_time",renderHeader:function(e){var t=e.title;return r().createElement("span",null,t)},renderCellContent:function(e){var t=e.cell_value;return e.is_footer?"":r().createElement("span",null,t," GMT")}},{title:(0,c.localize)("Sell price"),col_index:"sell_price",renderCellContent:function(t){var n=t.cell_value;return t.is_footer?"":r().createElement(l.Money,{amount:n,currency:e})}},{title:(0,c.localize)("Profit / Loss"),col_index:"profit_loss",renderCellContent:function(t){var n=t.cell_value;return r().createElement(b,{value:n},r().createElement(l.Money,{has_sign:!0,amount:n.replace(/[,]+/g,""),currency:e}))}}]}(n,a.length),S=Object.fromEntries(M.map((function(e){return[e.col_index,e]})));return r().createElement(r().Fragment,null,r().createElement(le,{filter_component:z,className:"profit-table__filter"}),y?r().createElement(D,{is_loading:!0}):r().createElement(r().Fragment,null,0===a.length||f?r().createElement(D,{is_loading:v,has_selected_date:E,is_empty:f,empty_message_component:_,component_icon:t,localized_message:(0,c.localize)("You have no trading activity yet."),localized_period_message:(0,c.localize)("You've made no transactions of this type during this period.")}):r().createElement("div",{className:"reports__content"},r().createElement(l.DesktopWrapper,null,r().createElement(l.DataTable,{className:"profit-table",data_source:a,columns:M,onScroll:h,footer:k,is_empty:f,getRowAction:ie,getRowSize:function(){return 63},content_loader:u},r().createElement(D,{is_loading:v}))),r().createElement(l.MobileWrapper,null,r().createElement(l.DataList,{className:"profit-table",data_source:a,rowRenderer:function(e){var t=e.row,n=e.is_footer,a=/^(MULTUP|MULTDOWN)/.test(t.shortcode)?"":t.duration_type,o=a?"duration-type__".concat(a.toLowerCase()):"";return n?r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:t,column:S.action_type,is_footer:n}),r().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:t,column:S.profit_loss,is_footer:n})):r().createElement(r().Fragment,null,r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:t,column:S.action_type}),r().createElement("div",{className:p()("duration-type",o)},r().createElement("div",{className:p()("duration-type__background","".concat(o,"__background"))}),r().createElement("span",{className:"".concat(o,"__label")},(0,c.localize)(a)))),r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:t,column:S.transaction_id}),r().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:t,column:S.currency})),r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:t,column:S.purchase_time}),r().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:t,column:S.buy_price})),r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:t,column:S.sell_time}),r().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:t,column:S.sell_price})),r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:t,column:S.profit_loss})))},getRowAction:ie,onScroll:h,footer:k,row_gap:8},r().createElement(D,{is_loading:v}))))))}))),se=(0,f.$j)((function(e){var t=e.modules,n=e.client;return{account_statistics:t.statement.account_statistics,currency:n.currency}}))((function(e){var t=e.account_statistics,n=e.currency;return r().createElement("div",{className:"statement__account-statistics"},r().createElement("div",{className:"statement__account-statistics-item"},r().createElement("div",{className:"statement__account-statistics--is-rectangle"},r().createElement(l.Text,{color:"less-prominent",className:"statement__account-statistics-title"},(0,c.localize)("Total deposits")," ",r().createElement(l.MobileWrapper,null," (",n,") ")),r().createElement(l.Text,{color:"prominent",weight:"bold",align:"center",className:"statement__account-statistics-amount"},r().createElement(l.Money,{amount:t.total_deposits,currency:n})))),r().createElement("div",{className:"statement__account-statistics-item statement__account-statistics-total-withdrawal"},r().createElement("div",{className:"statement__account-statistics--is-rectangle"},r().createElement(l.Text,{color:"less-prominent",className:"statement__account-statistics-title"},(0,c.localize)("Total withdrawals")," ",r().createElement(l.MobileWrapper,null," (",n,") ")),r().createElement(l.Text,{color:"prominent",weight:"bold",align:"center",className:"statement__account-statistics-amount"},r().createElement(l.Money,{amount:t.total_withdrawals,currency:n})))),r().createElement("div",{className:"statement__account-statistics-item"},r().createElement("div",{className:"statement__account-statistics--is-rectangle"},r().createElement(l.Text,{color:"less-prominent",className:"statement__account-statistics-title"},(0,c.localize)("Net deposits")," ",r().createElement(l.MobileWrapper,null," (",n,") ")),r().createElement(l.Text,{color:"prominent",weight:"bold",align:"center",className:"statement__account-statistics-amount"},r().createElement(l.Money,{amount:t.total_deposits-t.total_withdrawals,currency:n})))))})),ue=(0,f.$j)((function(e){var t=e.modules;return{action_type:t.statement.action_type,data:t.statement.data,date_from:t.statement.date_from,date_to:t.statement.date_to,filtered_date_range:t.statement.filtered_date_range,handleDateChange:t.statement.handleDateChange,handleFilterChange:t.statement.handleFilterChange}}))((function(e){var t=e.action_type,n=e.date_from,a=e.date_to,o=e.handleFilterChange,i=e.handleDateChange,s=e.filtered_date_range,u=[{text:(0,c.localize)("All transactions"),value:"all"},{text:(0,c.localize)("Buy"),value:"buy"},{text:(0,c.localize)("Sell"),value:"sell"},{text:(0,c.localize)("Deposit"),value:"deposit"},{text:(0,c.localize)("Withdrawal"),value:"withdrawal"},{text:(0,c.localize)("Transfer"),value:"transfer"}];return r().createElement(r().Fragment,null,r().createElement(oe,{input_date_range:s,onChange:i,from:n,to:a}),r().createElement(l.FilterDropdown,{dropdown_display_className:"dc-dropdown__display--has-suffix-icon",filter_list:u,handleFilterChange:o,initial_selected_filter:t}))}));function me(e){return me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},me(e)}var _e=function(e){var t=e.message,n=void 0===t?"":t,a=e.action_type,o=void 0===a?"":a,i=/:\s([0-9a-zA-Z]+.{25,28})/gm.exec(n.split(/,\s/)[0]),c=null==i?void 0:i[1],s=/:\s([0-9a-zA-Z]+.{25,34})/gm.exec(n.split(/,\s/)[1]),u=null==s?void 0:s[1],m=[n];if(c||u){var _=n.split(/,\s/);m=_.map((function(e,t){return t!==_.length-1?"".concat(e,", "):e}))}return r().createElement(l.Text,{as:"div",size:"xs",className:"statement__row--detail-text",align:"center"},m.map((function(e,t){return r().createElement("div",{key:e},e,u&&t===m.length-1&&r().createElement(l.Clipboard,{text_copy:u,popoverAlignment:"top"}),c&&"withdrawal"===o&&t===m.length-1&&r().createElement(l.Clipboard,{text_copy:c,popoverAlignment:"top"}))})))},de=function(e){var t,n={};if(e.id&&["buy","sell"].includes(e.action_type)){var a,o=(0,i.extractInfoFromShortcode)(e.shortcode).category.toUpperCase();n=(0,i.getSupportedContracts)()[o]&&!(0,i.isForwardStarting)(e.shortcode,e.purchase_time||e.transaction_time)?(0,i.getContractPath)(e.id):{message:"",component:r().createElement(c.Localize,{i18n_default_text:"The {{trade_type_name}} contract details aren't currently available. We're working on making them available soon.",values:{trade_type_name:null===(a=(0,i.getUnsupportedContracts)()[o])||void 0===a?void 0:a.name}})}}else"withdrawal"===e.action_type?n=e.withdrawal_details&&e.longcode?{message:"".concat(e.withdrawal_details," ").concat(e.longcode)}:{message:e.desc}:e.desc&&["deposit","transfer","adjustment","hold","release"].includes(e.action_type)&&(n={message:e.desc});return"object"===me(n)&&null!==(t=n)&&void 0!==t&&t.message&&(n.component=r().createElement(_e,{message:n.message,action_type:e.action_type})),n};const pe=(0,o.withRouter)((0,f.$j)((function(e){var t=e.modules,n=e.client;return{action_type:t.statement.action_type,account_statistics:t.statement.account_statistics,currency:n.currency,data:t.statement.data,date_from:t.statement.date_from,date_to:t.statement.date_to,error:t.statement.error,filtered_date_range:t.statement.filtered_date_range,handleDateChange:t.statement.handleDateChange,handleFilterChange:t.statement.handleFilterChange,handleScroll:t.statement.handleScroll,has_selected_date:t.statement.has_selected_date,is_empty:t.statement.is_empty,is_loading:t.statement.is_loading,is_mx_mlt:n.standpoint.iom||n.standpoint.malta,is_switching:n.is_switching,is_virtual:n.is_virtual,onMount:t.statement.onMount,onUnmount:t.statement.onUnmount}}))((function(e){var t=e.account_statistics,n=e.action_type,a=e.component_icon,o=e.currency,s=e.data,m=e.date_from,d=e.date_to,p=e.error,f=e.filtered_date_range,v=e.handleDateChange,g=e.handleFilterChange,h=e.handleScroll,E=e.has_selected_date,b=e.is_empty,N=e.is_loading,k=e.is_mx_mlt,z=e.is_switching,M=e.is_virtual,S=e.onMount,T=e.onUnmount;if(r().useEffect((function(){return S(),function(){T()}}),[]),p)return r().createElement("p",null,p);var j=function(e){return[{key:"icon",title:(0,i.isMobile)()?"":(0,c.localize)("Type"),col_index:"icon",renderCellContent:function(e){var t=e.passthrough,n=e.row_obj,a=t.isTopUp(n)?"icCashierTopUp":null;return r().createElement(C,{icon:a,key:n.transaction_id,payload:n})}},{title:(0,c.localize)("Ref. ID"),col_index:"refid",renderCellContent:function(e){var t=e.cell_value,n=e.row_obj;return r().createElement(l.Popover,{alignment:"top",message:(0,c.localize)("Transaction performed by (App ID: {{app_id}})",{app_id:n.app_id})},t)}},{title:(0,c.localize)("Currency"),col_index:"currency",renderCellContent:function(){return r().createElement(w,{currency:(0,i.getCurrencyDisplayCode)(e)})}},{title:(0,c.localize)("Transaction time"),col_index:"date",renderCellContent:function(e){var t=e.cell_value;return r().createElement("span",null,t," GMT")}},{key:"mode",title:(0,c.localize)("Transaction"),col_index:"action_type",renderCellContent:function(e){var t,n=e.cell_value,a=e.passthrough,o=e.row_obj;return r().createElement(l.Label,{mode:(t=n,x[t]||x.default)},a.isTopUp(o)&&(0,c.localize)("Top up")||o.action)}},{title:(0,c.localize)("Credit/Debit"),col_index:"amount",renderCellContent:function(t){var n=t.cell_value;return r().createElement("div",{className:"amount--".concat(y(n))},r().createElement(l.Money,{has_sign:!0,amount:n.replace(/[,]+/g,""),currency:e}))}},{title:(0,c.localize)("Balance"),col_index:"balance",renderCellContent:function(t){var n=t.cell_value;return r().createElement(l.Money,{amount:n.replace(/[,]+/g,""),currency:e})}}]}(o),I=j.reduce((function(e,t){return e[t.col_index]=t,e}),{});return r().createElement(r().Fragment,null,r().createElement(le,{className:k?void 0:"reports__meta--statement",filter_component:r().createElement(ue,{action_type:n,date_from:m,date_to:d,handleDateChange:v,handleFilterChange:g,filtered_date_range:f}),is_statement:!0,optional_component:!z&&k&&r().createElement(se,{account_statistics:t,currency:o})}),z?r().createElement(D,{is_loading:!0}):r().createElement(r().Fragment,null,0===s.length||b?r().createElement(D,{is_loading:N,has_selected_date:E,is_empty:b,empty_message_component:_,component_icon:a,localized_message:(0,c.localize)("You have no transactions yet."),localized_period_message:(0,c.localize)("You've made no transactions of this type during this period.")}):r().createElement("div",{className:"reports__content"},r().createElement(l.DesktopWrapper,null,r().createElement(l.DataTable,{className:"statement",columns:j,content_loader:u,data_source:s,getRowAction:function(e){return de(e)},onScroll:h,passthrough:{isTopUp:function(e){return M&&"Deposit"===e.action}}},r().createElement(D,{is_loading:N}))),r().createElement(l.MobileWrapper,null,r().createElement(l.DataList,{className:"statement",data_source:s,getRowAction:de,onScroll:h,rowRenderer:function(e){var t=e.row,n=e.passthrough;return r().createElement(r().Fragment,null,r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:t,column:I.icon,passthrough:n}),r().createElement(l.DataList.Cell,{row:t,column:I.action_type,passthrough:n})),r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:t,column:I.refid}),r().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:t,column:I.currency})),r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:t,column:I.date}),r().createElement(l.DataList.Cell,{className:"data-list__row-cell--amount",row:t,column:I.amount})),r().createElement("div",{className:"data-list__row"},r().createElement(l.DataList.Cell,{row:t,column:I.balance})))},row_gap:8,passthrough:{isTopUp:function(e){return M&&"Deposit"===e.action}}},r().createElement(D,{is_loading:N}))))))})));var fe=n("../stores/src/index.ts");const ve={OpenPositions:Y,ProfitTable:ce,Statement:pe,Reports:(0,fe.Pi)((function(e){var t,n=e.history,a=e.location,o=e.routes,s=(0,fe.oR)(),u=s.client,m=s.common,_=s.ui,d=u.is_logged_in,p=u.is_logging_in,f=u.setVisibilityRealityCheck,v=m.is_from_derivgo,y=m.routeBackInApp,g=_.is_reports_visible,h=_.setReportsTabIndex,E=_.reports_route_tab_index,C=_.toggleReports;r().useEffect((function(){return C(!0),function(){f(1),C(!1)}}),[]);var b=function(){var e=[];return o.forEach((function(t){e.push({default:t.default,icon:t.icon_component,label:t.getTitle(),value:t.component,path:t.path})})),e},w=(0,i.getSelectedRoute)({routes:o,pathname:a.pathname});return!d&&p?r().createElement(l.Loading,{is_fullscreen:!0}):r().createElement(l.FadeWrapper,{is_visible:g,className:"reports-page-wrapper",keyname:"reports-page-wrapper"},r().createElement("div",{className:"reports"},r().createElement(l.PageOverlay,{header:(0,c.localize)("Reports"),onClickClose:function(){return y(n)},is_from_app:v},r().createElement(l.DesktopWrapper,null,r().createElement(l.VerticalTab,{is_floating:!0,current_path:a.pathname,is_routed:!0,is_full_width:!0,setVerticalTabIndex:h,vertical_tab_index:w.default?0:E,list:b()})),r().createElement(l.MobileWrapper,null,r().createElement(l.Div100vhContainer,{className:"reports__mobile-wrapper",height_offset:"80px"},r().createElement(l.SelectNative,{className:"reports__route-selection",list_items:b().map((function(e){var t;return{text:e.label,value:null!==(t=e.path)&&void 0!==t?t:""}})),value:null!==(t=w.path)&&void 0!==t?t:"",should_show_empty_option:!1,onChange:function(e){return n.push(e.target.value)},label:"",hide_top_placeholder:!1}),(null==w?void 0:w.component)&&r().createElement(w.component,{icon_component:w.icon_component}))))))}))}}}]);